---
name: OpenClaw Troubleshooting
description: Essential guide for fixing communication, permission, and configuration issues with OpenClaw Docker agents.
---

# OpenClaw Docker Communication Troubleshooting Guide

This guide documents how communication between the `worker` and `OpenClaw` agents works and how to troubleshoot common issues.

## 1. Directory Structure & Volume Mounts

The worker manages agent workspaces on the host and mounts them into the containers.

**Host Path**: `packages/worker/workspaces/<agent-id>/.openclaw`
**Container Path**: `/home/node/.openclaw`

### Common Issues:
- **Permission Denied (EACCES)**: If the host directory is created by a process with higher privileges (e.g., `root`), the worker (running as user `adam`) cannot write the `openclaw.json`.
- **Path Mismatch**: If `HOST_WORKSPACES_PATH` in `.env` doesn't match the absolute path resolution in `openclaw.ts`, the container might mount an empty or incorrect directory.

**Fix**:
```bash
# Force ownership to the local user
sudo chown -R $USER:$USER packages/worker/workspaces
```

## 2. Configuration (`openclaw.json`)

The `openclaw.json` is generated by the worker for each agent.

### Critical Fields:
- **API Protocol**: For OpenAI-compatible providers like **Venice AI**, the `api` field in the model definition MUST be `openai-completions`. (Note: Do not use `openai-responses` as it may lead to 403 errors in some environments).
- **Gateway Endpoints**: To allow external communication (like the backend proxy), the `chatCompletions` endpoint must be explicitly enabled.

```json
"gateway": {
  "http": {
    "endpoints": {
      "chatCompletions": { "enabled": true }
    }
  }
}
```

## 3. Networking

Agents run in a dedicated Docker network (usually `blueprints-network`).

- **Port Mapping**: The worker dynamically assigns host ports (e.g., `19812`) to the container's internal port (`18789`).
- **Connection Reset**: If you see `Connection reset by peer`, the container is up but the OpenClaw process inside hasn't finished initializing its plugins or the gateway server. Wait ~10 seconds.

## 4. Troubleshooting Steps

1. **Check Worker Logs**: Look for `EACCES` or SQL errors.
2. **Inspect Container Config**:
   ```bash
   docker exec <container-name> cat /home/node/.openclaw/openclaw.json
   ```
3. **Verify Gateway Status**:
   ```bash
   docker logs <container-name> | grep "listening on"
   ```
4. **Test Manually**:
   ```bash
   curl -X POST http://localhost:<host-port>/v1/chat/completions ...
   ```
